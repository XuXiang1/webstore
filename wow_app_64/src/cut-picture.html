<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<title></title>
		<link rel="stylesheet" type="text/css" href="bootstrap.css" />
		<link rel="stylesheet" type="text/css" href="css/imgareaselect-default.css" />
		<script src="jquery-1.9.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="scripts/jquery.imgareaselect.js" type="text/javascript" charset="utf-8"></script>
		<style>
			img {
				width: 100%;
				height: 100%;
				border: 2px solid blue;
			}
			
			body {
				width: 100%;
				height: 100%;
				overflow: hidden;
				overflow-x: hidden !important;
				overflow-y: hidden !important;
				background-color: gray;
			}
		</style>
		<script>
			window.x = 0;
			window.y = 0;
			$(document).ready(function() {
				$('#ladybug_ant').imgAreaSelect({
					maxWidth: 1920,
					maxHeight: 1080,
					handles: true,
					onSelectEnd: function(img, selection) {
						var x = selection.x1,
							y = selection.y1,
							width = selection.x2 - selection.x1,
							height = selection.y2 - selection.y1;
						$("canvas").remove();
						var canvas = $('<canvas width="' + width + '" height="' + height + '"></canvas>')[0],
						ctx = canvas.getContext('2d');
						//ctx.drawImage(img, x * 2, y * 2, width * 2, height * 2, 0, 0, width, height);
						ctx.drawImage(img,x,y,width,height,0,0,width,height);//全屏用这个
						fs = require('fs');
						// string generated by canvas.toDataURL()
						var img = canvas.toDataURL();
						// strip off the data: url prefix to get just the base64-encoded bytes
						var data = img.replace(/^data:image\/\w+;base64,/, "");
						var buf = new Buffer(data, 'base64');
						fs.writeFile('imagecat.png', buf);
						window.close();
					}
				});
			});
		</script>
	</head>

	<body>
		<img id="ladybug_ant" src="../image.png" />
	</body>

</html>